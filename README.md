code from 侯捷's courses
